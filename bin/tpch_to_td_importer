#!/usr/bin/env ruby
require 'tpch_to_td_importer'
require 'optparse'

if $0 == __FILE__
  apikey = nil
  db = nil
  indir = nil
  dryrun = false

  opt = OptionParser.new
  opt.on('-k APIKEY') { |v| apikey = v }
  opt.on('-d DBNAME') { |v| db = v }
  opt.on('-i DATASET_DIR') { |v| indir = v }
  opt.on('--dry-run') { |v| dryrun = true }

  opt.parse!(ARGV)
  raise "usage: #{$0} -k apikey -d database -i (dataset_dir)" unless apikey && db && indir
 
  puts "database: #{db}"
  puts "tpch *.tbl input directory: #{indir}"  
 
  importer = TpchToTdImporter::Importer.new(apikey)
  importer.import(db, indir, dryrun)
end

